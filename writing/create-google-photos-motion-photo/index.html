<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Joel Kitching"><link rel="shortcut icon" href=https://joelkitching.com/favicon.ico><link rel=stylesheet href=/css/style.min.css><link rel=canonical href=https://joelkitching.com/writing/create-google-photos-motion-photo/><title>Convert iPhone Live Photo to Google Photos motion photo</title></head><body><header id=banner><h2><a href=https://joelkitching.com/>Joel Kitching</a></h2><nav><ul><li><a href=/ title>writing</a></li><li><a href=/about/ title>about</a></li><li><a href=https://github.com/jkitching title>github</a></li><li><a href=https://www.linkedin.com/in/joelkitching title>linkedin</a></li></ul></nav></header><main id=content><article><header id=post-header><h1>Convert iPhone Live Photo to Google Photos motion photo</h1><div><time>May 27, 2024</time></div></header><p>Google Photos has two methods of handling motion photos:</p><ol><li><p>If the photo was uploaded by an Android device, it will already be in Google&rsquo;s custom format, which is essentially a JPEG file with a video file concatenated to the end.</p></li><li><p>If the photo was uploaded by an iPhone, it will be stored as two separate files on Google servers: HEIC and MOV.</p></li></ol><p>When downloading motion photos and re-uploading them to a different Google Photos account, the Android case works fine, since everything is packed together as one file. In the iPhone case, however, you will end up uploading the HEIC and MOV files separately, which will not be recognized by Google Photos as a motion photo, and will instead displayed as two separate entities. What&rsquo;s the solution?</p><h1 id=script-for-creating-a-motion-photo>Script for creating a motion photo</h1><p>Download script from GitHub: <a href=https://gist.github.com/jkitching/3fa5a0c238fa825278db83acd05d7742>combine_photo_video.sh</a></p><p>This script takes a photo file and a video file, and combines the two into the format recognized by Google Photos. It depends on <a href=https://exiftool.org/>exiftool</a> for adding the XMP block.</p><p>Simply run the script with three arguments:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>./combine_photo_video.sh &lt;photo_file&gt; &lt;video_file&gt; &lt;output_file&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># For example, combine IMG_9077.heic and IMG_9077.mov:</span>
</span></span><span class=line><span class=cl>./combine_photo_video.sh IMG_9077.heic IMG_9077.mov IMG_9077_motion.jpg
</span></span></code></pre></div><p>Upload the resulting file to Google Photos (either through the app or web version), and you will get a motion photo!</p><h1 id=technical-explanation>Technical explanation</h1><p>Motion photo JPEG files have an extra XMP block. There are <a href=https://linuxreviews.org/Google_Pixel_%22Motion_Photo%22>two different versions in use</a>. The newer one has the advantage of assuming the client will locate the video file on its own, and appears to work even when specifying the video file length as &ldquo;0&rdquo;:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;Container:Directory&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;rdf:Seq&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;rdf:li</span> <span class=na>rdf:parseType=</span><span class=s>&#34;Resource&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;Container:Item</span>
</span></span><span class=line><span class=cl>        <span class=na>Item:Mime=</span><span class=s>&#34;image/jpeg&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>Item:Semantic=</span><span class=s>&#34;Primary&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>Item:Length=</span><span class=s>&#34;0&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>Item:Padding=</span><span class=s>&#34;0&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/rdf:li&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;rdf:li</span> <span class=na>rdf:parseType=</span><span class=s>&#34;Resource&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;Container:Item</span>
</span></span><span class=line><span class=cl>        <span class=na>Item:Mime=</span><span class=s>&#34;video/mp4&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>Item:Semantic=</span><span class=s>&#34;MotionPhoto&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>Item:Length=</span><span class=s>&#34;0&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>Item:Padding=</span><span class=s>&#34;0&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/rdf:li&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;/rdf:Seq&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/Container:Directory&gt;</span>
</span></span></code></pre></div><p>More about the actual code for parsing and extracting video data here: <a href=https://gitlab.gnome.org/GNOME/shotwell/-/issues/233#note_1712445>shotwell issue 233</a>.</p><h1 id=limitations>Limitations</h1><ul><li>Unfortunately, HEIC files need to be converted to JPEG as part of this process.</li><li>Existing XMP data is wiped out as part of this process. But it is unlikely that it exists anyways, unless the image file has been edited with Adobe products.</li></ul></article></main><footer id=footer>Copyright © 2022–2024 Joel Isaac Stewart Davies-Kitching</footer></body></html>