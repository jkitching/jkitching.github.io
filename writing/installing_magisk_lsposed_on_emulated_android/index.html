<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Joel Kitching"><link rel="shortcut icon" href=https://joelkitching.com/favicon.ico><link rel=stylesheet href=/css/style.min.css><link rel=canonical href=https://joelkitching.com/writing/installing_magisk_lsposed_on_emulated_android/><title>Installing Magisk and LSPosed on emulated Android</title></head><body><header id=banner><h2><a href=https://joelkitching.com/>Joel Kitching</a></h2><nav><ul><li><a href=/ title>writing</a></li><li><a href=/about/ title>about</a></li><li><a href=https://github.com/jkitching title>github</a></li><li><a href=https://www.linkedin.com/in/joelkitching title>linkedin</a></li></ul></nav></header><main id=content><article><header id=post-header><h1>Installing Magisk and LSPosed on emulated Android</h1><div><time>May 28, 2024</time></div></header><p>After attempting many different ways of getting Magisk to run on Android emulators (including Waydroid and the like), the only way that worked is using the official emulator from Google, along with the instructions from the following Gist:</p><p><a href=https://gist.github.com/tothi/1a206791c8b77d7e42015183c980657e>tothi/magisk_ramdisk_patch_avd.sh</a></p><h1 id=notes>Notes</h1><ul><li><p><code>userdata.img</code> needs to be recreated when changing size via the <code>emulator -memory</code> flag, so pick its size carefully! 8 GB can fill up very quickly.</p></li><li><p>I placed <code>ramdisk-patched.img</code> in <code>~/.android/avd/android14-play.avd/</code> to keep it alongside other files for this AVD.</p></li><li><p>You may want to avoid using snapshots while getting your AVD setup, but they can be useful later on.</p></li></ul><p>Here are the command-line flags I use to start the emulator:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>emulator @android14-play -memory <span class=m>16384</span> -cores <span class=m>8</span> -no-audio -feature -Vulkan -gpu host -ramdisk ~/.android/avd/android14-play.avd/ramdisk-patched.img
</span></span></code></pre></div><h1 id=userspace-installation>Userspace installation</h1><p>After getting the emulated device up and running with a patched <code>ramdisk.img</code>, finish setting up Magisk as follows:</p><ol><li><p>Install Magisk by sideloading the APK: <code>adb install Magisk-v27.0.apk</code>. See the <a href=https://github.com/topjohnwu/Magisk/releases/>GitHub releases page</a>.</p></li><li><p>Open up Magisk. (Note that the app may not show up in the apps list until Android initial setup has completed.) Follow the prompt requesting for a reboot to perform &ldquo;additional setup&rdquo;.</p></li><li><p>Copy the LSPosed zygisk ZIP over to the device: <code>adb push LSPosed-v1.9.2-7024-zygisk-release.zip /sdcard/Download/</code>. LSPosed is no longer under development, so download the <a href=https://github.com/LSPosed/LSPosed/releases/download/v1.9.2/>last available release</a> from GitHub.</p></li><li><p>Open up Magisk and select the Modules tab. Choose &ldquo;Install from storage&rdquo; and select the LSPosed ZIP file. After installing, you will be prompted to reboot again.</p></li><li><p>After rebooting, you should have a silent notification &ldquo;LSPosed loaded&rdquo;. Tap to open the LSPosed interface, and choose whether you want to add an app shortcut.</p></li><li><p>Now you can search for modules in the &ldquo;Repository&rdquo; tab and install them!</p></li></ol></article></main><footer id=footer>Copyright © 2022–2024 Joel Isaac Stewart Davies-Kitching</footer></body></html>